# GitHub Copilot カスタムインストラクション

このドキュメントに記載された指示に加えて、以下のリンク先ドキュメントの内容も指示として考慮してください:
- [Agent開発ガイドライン](./agents/AGENTS.md) - エージェントの役割とプロジェクトサマリー

## 言語ポリシー

このリポジトリでは、以下の言語ポリシーを遵守してください:

### 日本語を使用する箇所

1. **PRのタイトルとサマリー**: すべてのPull Requestのタイトルと説明は日本語で記述してください
2. **コミットメッセージ**: すべてのコミットメッセージは日本語で記述してください
3. **コードレビューコメント**: レビューコメントは日本語で記述してください
4. **Issue**: Issueのタイトルと説明は日本語で記述してください
5. **仕様書とドキュメント**: spec.md、plan.md、tasks.mdなど、すべての仕様書とドキュメントは日本語で記述してください
6. **Agentとのやり取り**: GitHub Copilot Agentとのすべてのやり取りは日本語で行ってください

### 英語を使用する箇所

1. **コード**: 変数名、関数名、クラス名、コメントは英語で記述してください
2. **技術用語**: 技術的な固有名詞はそのまま英語を使用してください（例: OIDC, CDK, CloudFormation）

## コミットID提示のルール

エージェントがコメントでコミットIDを提示する際は、必ずGitHubへのリンクを付ける:

**形式**:
```
Commit: [短縮SHA](https://github.com/goataka/attendance-kit/commit/完全SHA)
```

**例**:
```
Commit: [be9f233](https://github.com/goataka/attendance-kit/commit/be9f233)
```

**理由**:
- ユーザーがワンクリックでコミット内容を確認可能
- コードレビューの効率化
- 変更履歴の追跡性向上

## 変更時の確認手順

### コード変更の場合
- ビルド確認: `npm run build`
- テスト実行: `npm test`
- Lint実行（該当する場合）
- 変更が意図した箇所のみに限定されているか確認

### ドキュメント変更の場合
- Markdownフォーマットチェック
- リンク切れチェック
- 日本語/英語の言語ポリシーに準拠しているか確認

### Mermaid図の変更の場合
- 描画エラーがないか確認
- ブラウザまたはエディタでプレビュー確認

### 反復確認の原則
- 変更対象の漏れがないか、全ファイルを確認
- 類似パターンの箇所を検索し、一貫性を確保
- 変更後に影響範囲を再チェック

## ドキュメント配置の原則

### ドキュメント構造ポリシー

1. **戦略的・概念的なドキュメント**: `docs/`ディレクトリに配置
   - アーキテクチャ設計
   - ビジネス要件
   - デプロイメント戦略

2. **運用的・手順的なドキュメント**: 該当ファイルと同じフォルダに配置
   - ワークフロー詳細: `.github/workflows/`に`{workflow-name}.md`
   - インフラ運用: `infrastructure/`に`DEPLOYMENT.md`等
   - セットアップ手順: `infrastructure/setup/`に`README.md`

3. **アクションドキュメントの命名規則**
   - ワークフローファイル: `{name}.yml`
   - ドキュメント: `{name}.md`（同じフォルダに配置）
   - サマリー: `README.md`（ディレクトリ全体の概要）

4. **冗長性の回避**
   - 「関連ドキュメント」セクションは記載しない
   - システム名など変更箇所が増える記述は必須でない場所には記載しない
   - 保守負担を最小化するため、重複情報を避ける

5. **ナンバリングの回避**
   - タスクやステップの番号付けは極力しない（変更箇所が増えるため）
   - 順序を示す必要がある場合は、リスト構造で表現し、タスク内容には番号を含めない
   - 例: ❌ "タスク 1: XXX" → ✅ "タスク: XXX"（リストの順序で表現）

### マークダウンファイルの言語ルール

1. **日本語の説明に続く英語翻訳は削除する**
   - 例: "概要 / Overview" → "概要"

2. **保持すべき英語**:
   - 技術用語（Docker, Python, Git, etc.）
   - コマンド名とコード例
   - ファイル名とパス
   - URL と外部参照

3. **確認方法**:
   ```bash
   # 日本語/英語の形式をチェック
   grep -n " / " [file.md]
   ```

## Mermaid図の活用

### ルール

- Markdown内の図はMermaidを使用して作成してください

### 理由

- テキストベースでバージョン管理可能
- レビューが容易
- 保守性が高い
- GitHubで直接レンダリング可能

### 図の種類

- システムアーキテクチャ: `graph` または `flowchart`
- シーケンス図: `sequenceDiagram`
- ER図: `erDiagram`
- 状態遷移図: `stateDiagram-v2`
- クラス図: `classDiagram`
- ガントチャート: `gantt`

## セキュリティ要件

- IAM権限は特定のリソースパターンにスコープし、ワイルドカード(`*`)の使用を避けてください
- OIDC信頼ポリシーはリポジトリ固有のGitHub Actionsに制限してください
- AWSマネージドポリシー（PowerUserAccessなど）の使用は最小限にし、必要な権限のみを付与してください

## コスト最適化

- CloudWatch アラームなど、コストがかかる監視機能は初期段階では実装しないでください
- DynamoDB は On-Demand 課金モデルを使用してください
- 無料枠の範囲で利用できる基本的なメトリクスのみを使用してください

